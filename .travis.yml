language: rust
rust: nightly-2019-02-01

install:
  - sudo apt-get install -y curl make gcc python python-crypto xz-utils
  - rustup component add rust-src
  - rustup target install aarch64-unknown-linux-gnu
  - cargo install --git https://github.com/mssun/xargo.git --branch mssun/relative-patch-path --force

script:
  - make optee
  - source environment
  - cd $TRAVIS_BUILD_DIR/optee_utee && xargo build --target aarch64-unknown-optee-trustzone -vv
  - cd $TRAVIS_BUILD_DIR/optee_teec && cargo build --target aarch64-unknown-linux-gnu -vv
  - cd $TRAVIS_BUILD_DIR && make examples
